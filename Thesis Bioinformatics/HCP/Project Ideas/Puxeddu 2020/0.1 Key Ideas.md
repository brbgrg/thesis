### Aim
- the principal aim of this study was to investigate ==age-related changes== of the **human connectome modular organization**
	- broaden a body of literature aimed at understanding connectome evolution across lifespan
	- investigating the evolution of the properties of temporal multilayer networks
	- by developing and applying a novel ensemble multi-layer approach
	- provide a plausible description of the evolution of the connectome’s modular structure during a large portion of the lifespan
- here, we are interested in an intermediate regime, in which modules reconfigure across longer time periods, while also remaining robust across shorter time periods
	- we aimed to find any relationship between age and segregation of the brain subnetworks
		- analyze modularity Q
	- quantify the extent to which modular structure changes with age
		- layer flexibility Fl
	- and which brain regions are more likely to change community membership (modular allegiance)
		- node flexibility Fi 
	- examined how structural modules are topographically distributed on the cortical surface across the lifespan
	- characterize the integration of the different brain areas with respect to the whole network and the modules to which they belong
		- participation coefficient p_i


### Method

#### dataset
- we processed diffusion MRI data of the NKI dataset

#### issues
- comparison among subjects, or categories of subjects, based on the analysis of their MRI networks 
	- MRI networks exhibit unique, subject-specific, patterns of connections
- heterogeneity in the age distribution

#### strategy
- ==ensemble-based strategy==, in which a network average is computed many times on a small subset of subjects
	- link changes of structural connectivity specifically to development, maturation, and aging processes, while minimizing the impact of individual differences not due to age
	- overcomes heterogeneity in the age distribution
- thanks to the large data sample, we could build a multilayer network where layers represent narrow age intervals (2 years)
	- avoided comparing modular structure across large age groups (usually children, adults, and elderly participants) that are internally highly heterogeneous
	- could monitor modules’ properties over an extended period of the lifespan
- to track the evolution of modules across the lifespan, we adopted a ==multilayer community detection algorithm== that identifies assortative communities
	- modular architecture represents a neurobiologically meaningful aspect of brain connectivity
	- advantage of partitioning all the network’s slices simultaneously, providing consistent partitioning of nodes across the layers and facilitating comparison of modules
		- these are matched so that one can determine which brain regions change modular allegiance and in which period in the lifespan 
		- rather than working independently on snapshots, this unified framework is more suitable to monitor age-related modules variations
- by optimizing multilayer modularity, we explored the connectome’s architecture at multiple spatial and temporal scales, as evidence suggests that the human brain network can be parsed in several– physiologically equally meaningful– ways
	- however, after having obtained modules with different sizes and degrees of variability across layers, we focused on a specific subset. 
	- we were interested in modules that reconfigure in an intermediate time scale, neither too fast nor too slow. 
	- to identify a proper scale, we considered the VI matrix which we hypothesized should have high similarity between partitions on the main diagonal and lower values outside
	- we focused on a spatial scale that returned a number of modules consistent with canonical functional systems, which have also been identified in a previous analysis of structural connectivity 
		- while there is no exact number of modules with which brain networks must be divided, current practice has converged onto a set of functional modules which are reliably observed 
			- they usually include the visual, somatomotor, dorsal attention, limbic, default mode, control and salience systems. 
		- previous works demonstrated that structural and functional connectivity matrices are significantly related supporting the notion that structural connectivity underpins and drives functional organization
#### generating the ensemble of multilayer networks
- implemented a probabilistic procedure based on bootstrapping to extract an ensemble of multilayer networks representative of the ==anatomical connectome== at different ages. 
	- layers represent homogeneous and contiguous age intervals
	- each layer represents a mean model of structural connectivity in an age range covering 2 years
- we generated an ==ensemble of 1000 such multilayer networks==
	- division of the dataset into 39 temporal bins, identified by color code, each spanning 2 years and comprised of a different number of subjects
	- random selection of 10 networks within each temporal bin
	- averaging of each subset of networks
	- iterated 1000 times to obtain 1000 multilayer networks made of 39 layers

#### identifying modules
- we identified their modular structure through a ==multilayer modularity optimization algorithm== (Louvain algorithm), obtaining for each layer the brain regions’ **community assignment**. 
	- The output of this algorithm depends on two parameters defining spatial and temporal resolution, γ and ω. 
		- ω = inter-layer coupling
	- community detection algorithms have stochastic properties 
		- result in outputs with increasing heterogeneity as the size of the network increases
		- can exhibit degeneracies 
	- pursued an ==ensemble-based resampling approach==
		- instead of applying the algorithm multiple times on a given network and then selecting a partition, we applied it once for each member of a set of equivalent multilayer networks, and we statistically described the ensemble of output partitions, focusing on statistical consistency
		- this approach aims to highlight meaningful trends and mitigate variations due to chance, which can be encountered relying on a single representation of community structure

#### parameter tuning
- choice of different temporal/spatial scales could lead to different properties of the age-related brain community organization
- among the **parameter values** we considered for γ and ω we identified a combination that returns a multilayer community structure with a biologically ==plausible number of modules== that exhibit a ==reasonable rate of reconfiguration== on a physiological time scale. 
	- omit ω values producing communities that do not consistently vary across the layers, or whose variation rate is excessively high even over networks representing close ages.
	- consider γ values producing partitions with a number of clusters (and their size) consistent with the number of large-scale anatomical and functional subnetworks derived in previous work (around ten).
		- allows us to relate them to previously established subdivisions of the brain into functionally specialized systems
- we ==tuned== both parameters in order to examine partitions at different ==spatial and temporal scales==, which affect the number of clusters, their size, and their reconfiguration rate across the lifespan.
	- temporal scale:
		- high ω (ω = 1, 5), could highlight possible structures that do not change over the lifespan.
			- stable communities that span several layers
			- partitions appear barely variable, even at the extremes of the lifespan
			- VI between two partitions r and s is low
		- low ω (ω = 0.1), could represent community structure expressed in specific age ranges. 
			- communities that rarely cover multiple layers
			- partitions respectively appear highly variable, even between consecutive layers
			- dissimilarity score between two general partitions r and s is high
		- Here, we are interested in an ==intermediate regime== (ω = 0.5), in which modules reconfigure across longer time periods, while also remaining ==robust== across shorter time periods.
			- communities tend to be similar along the main diagonal of the matrix (VI $\approx$ 0), namely along consecutive years of the lifespan, but they diverge more and more farther away from the main diagonal
	- spacial scale:
		- γ = 2 most closely resembles the number of large-scale anatomical and functional systems derived in previous studies
			- on average 9–12 clusters made of 8–12 nodes each
			- produces continuous variations in cluster sizes
			- number of communities increases with age
		- $γ \le 1$
			- γ = 0.5 yielded 2–3 modules comprising about 40–60 nodes each
			- γ = 1 we obtained partitions made of 4–6 modules composed of 20–30 nodes.
			- number of communities decreases with age
		- lower γ-values produce partitions with only few clusters which can be trivially reduced to the two hemispheres 
		- higher values of γ lead to larger numbers of communities composed of few nodes, which do not match with established schemes for functional systems in the human brain.
- we restrict the following investigations on the multilayer modular structure identified by optimizing the multilayer modularity in the subset of parameters $[γ = 2, ω = 0.5]$

### Measures
- ==Variation of Information== (VI) matrices obtained for each tested parameter combination
	- VI matrices are square matrices of dimensions equal to the number of layers (i.e. 39), in which each entry represents the distance between layer r and layer s. 
	- They allow us to visually evaluate the similarity of partitions across layers.
- ==node flexibility==, fi, represents the percentage of partitions in which node i changes its community allegiance. It allows us to quantify the **strength with which brain regions reconfigure across the lifespan**.
- The ==layer flexibility==, fl, is measured between all the pairs of consecutive partitions and captures the average node flexibility between such partitions. It enables us to investigate the possible existence of **age stages in which brain modular organization strongly rearranges**.
- ==single layer modularity== Q, computed both for our actual model (Qobs) and for the null model (Qnull), returns an estimation of the extent to which communities are internally connected or segregated one from another.
- ==participation coefficient== p_i of a node quantifies how uniformly distributed its connections are across modules. 
	- The smaller it is the more the node interacts exclusively with other nodes of the cluster to which it belongs

### Testing significance and robustness

- The above-listed measures were computed on each one of the 1000 resulting multilayer partitions
- robustness and statistical consistency are also promoted by the large sample size of participants
- We verified the significance of the temporal evolution of these measures through a comparison with a temporal ==null model== 
	- built an ensemble of null-case multilayer networks following steps a) and b) of section 2.2 and then randomly permuted the network’s layers within each iteration
		- time is scrambled by randomly permuting the net work’s layers
	- test whether results obtained from the ensemble of lifespan multi-layer networks were robust against permutations of the age structure of the data
		- within each time point, we statistically compared the distribution of the values of the indices computed on the actual model with those computed in the null model
		- We made this statistical comparison through a ==permutation test==, with 100.000 permutations and a significance α = 0.05
		- We could perform this temporal validation thanks to the 1000 replications that we had available for both models, which resulted in two different distributions of the communities-related indices (for each layer)
		

### Results and plausible causes

- in each figure of the manuscript, we reported the average values of the investigated indices together with their confidence interval
- these intervals barely deviate from the average values, meaning that the partitions and their structural properties, even if not identical, are quite consistent across the iterations


- results obtained in this study confirm that the human connectome’s modular structure is ==age-dependent==
- results agree with ==previous findings==
- Some brain regions appeared to be less prone to age-related changes
	- low flexibility  
	- non-age-related values of the participation coefficient
- brain areas which reconfigure most across the lifespan 
	- high nodal flexibility
	- age-related values of the participation coefficient
	- reconfigure in different ways
- alterations found on structural organization might underpin functional age-related alterations observed in the same areas
- network becomes more segregated with years, with the appearance of hemispherically-specific modules
- the number of intra-cluster edges decreases with age, while their weight increases, causing non-linear trends of modularity and participation coefficient
- overall, the modules’ reconfiguration rate increases with age

#### Modularity
- number of clusters increasing with age
	- from 9 in the early lifespan to 12 in the late lifespan
- as a consequence, their size decreases
- increased modularity Q (wrt null model) observed at the extremes of lifespan
	- metric of modularity exhibits an age-related U-shaped trend (non-linear)
- causes:
	- Q is proportional to the difference between the within module weights of the network and those in the configuration null model multiplied by γ, within each cluster
	- in the early lifespan modules are internally densely connected
		- higher number of intra-clusters edges in early lifespan 
	- in the late lifespan they are internally strongly connected
		- higher weights of intra-custers edges in late lifespan

#### Layer and node flexibility
- flexibility of brain regions linearly increases with age 
	- modular organization tends to reconfigure more and more as age advances
- causes:
- differences in the modules composition
	- observed only between the last and the first two age groups, but not between the first two

#### Topological distribution on the cortical surface of structural modules  
- linear drop of inter-hemispheric modules
- causes:
	- drop of inter-hemispheric connections
	- physiological age-related shrinkage of the corpus callosum

#### Participation coefficient 
- inverted U-shaped curve followed by the participation coefficient
	- positive correlation with age: nodes become more integrated in the network
	- negative correlation with age: nodes become more segregated
- causes:
	- inverted U-shaped trend observed for the number of inter-clusters connections

### limitations and future advancements

- MRI data
	- Diffusion imaging and tractography provide an estimation of the anatomical connectivity, but not a direct measurement of it 
	- through our approach to network construction and the multi-layer resampling methodology, we tried to ameliorate some biases such as the paucity of long-range connections detected with tractography data

- node definition
	- this choice might impact the properties of the derived network (Fornito et al., 2010)
	- in order to be consistent with previous studies (Betzel et al., 2015, 2014; Cao et al., 2014; Faskowitz et al., 2018), we used a parcellation of the cortex based on a canonical partition of the surface into functional sub-systems
	- to add robustness to our findings, future works could replicate the same analysis with a finer parcellation, or by defining nodes according to anatomical constraints (Destrieux et al., 2010)
- while our study included much of the human lifespan, it did not cover early postnatal stages of development (ages 0–5 years)
	- as more data covering this early lifespan period becomes avail able, our ensemble multi-layer approach could be extended to cover the human lifespan more fully and comprehensively
- the goal would be assessing the impact of specific pathologies on developmental or aging processes and helping to identify targeted interventions. 
	- further studies might also attempt to correlate connectional features with behavioral features and normalize interindividual variations in cognition relative to the actual developmental status